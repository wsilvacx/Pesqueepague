
<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Montar Horário Escolar</title>
<style>
body { font-family: Arial; margin:0; padding:0; background:#f0f2f5;}
header { background:#2463ff; color:#fff; padding:15px; text-align:center; }
main { display:flex; gap:20px; padding:20px; flex-wrap:wrap;}
section { background:#fff; padding:15px; border-radius:10px; box-shadow:0 2px 5px rgba(0,0,0,.1); }
#prateleira { width:200px; min-width:200px; }
.item { background:#2463ff; color:#fff; padding:5px; margin:5px 0; border-radius:5px; cursor:grab; }
table { border-collapse:collapse; width:100%; }
th, td { border:1px solid #ccc; padding:8px; text-align:center; min-width:80px; height:40px; }
td { background:#fafafa; }
td.dragover { background:#cce5ff; }
</style>
</head>
<body>

<header><h1>Montar Horário Escolar</h1></header>
<main>
  <!-- Prateleira -->
  <section id="prateleira">
    <h2>Disciplinas</h2>
    <div id="disciplinas"></div>
  </section>

  <!-- Tabela de Horário -->
  <section style="flex:1;">
    <h2>Horário</h2>
    <table id="tabelaHorario">
      <thead>
        <tr>
          <th>Horário</th>
          <th>Segunda</th>
          <th>Terça</th>
          <th>Quarta</th>
          <th>Quinta</th>
          <th>Sexta</th>
        </tr>
      </thead>
      <tbody>
        <tr><td>07:00-08:00</td><td></td><td></td><td></td><td></td><td></td></tr>
        <tr><td>08:00-09:00</td><td></td><td></td><td></td><td></td><td></td></tr>
        <tr><td>09:00-10:00</td><td></td><td></td><td></td><td></td><td></td></tr>
      </tbody>
    </table>
  </section>
</main>

<script>
// Exemplo de dados: disciplinas + professor + meta
const professores = [
  {nome:'João', disciplinas:['Matemática'], meta:{'Matemática':3}},
  {nome:'Maria', disciplinas:['Português','História'], meta:{'Português':4,'História':2}},
  {nome:'Carlos', disciplinas:['Física'], meta:{'Física':2}}
];

// Montar prateleira
const prateleira = document.getElementById('disciplinas');
professores.forEach(p => {
  p.disciplinas.forEach(d => {
    const div = document.createElement('div');
    div.className = 'item';
    div.draggable = true;
    div.textContent = `${d} - ${p.nome}`;
    div.dataset.professor = p.nome;
    div.dataset.disciplina = d;
    div.dataset.meta = p.meta[d];
    div.dataset.count = 0;
    div.addEventListener('dragstart', dragStart);
    prateleira.appendChild(div);
  });
});

// Drag & Drop
function dragStart(e){ e.dataTransfer.setData('text', e.target.textContent); e.dataTransfer.setData('professor', e.target.dataset.professor); e.dataTransfer.setData('disciplina', e.target.dataset.disciplina);}
const cells = document.querySelectorAll('#tabelaHorario td');
cells.forEach(td=>{
  td.addEventListener('dragover', e=>{ e.preventDefault(); td.classList.add('dragover'); });
  td.addEventListener('dragleave', e=>{ td.classList.remove('dragover'); });
  td.addEventListener('drop', e=>{
    e.preventDefault();
    td.classList.remove('dragover');
    const professor = e.dataTransfer.getData('professor');
    const disciplina = e.dataTransfer.getData('disciplina');
    const item = Array.from(prateleira.children).find(i=>i.dataset.professor===professor && i.dataset.disciplina===disciplina);

    // validação de meta
    let count = Number(item.dataset.count);
    let meta = Number(item.dataset.meta);
    if(count >= meta){
      alert(`⚠️ Meta de aulas atingida para ${disciplina} - ${professor}`);
      return;
    }

    // validação de conflito: professor não pode estar em duas células
    let conflito = Array.from(cells).some(c => c.textContent.includes(professor));
    if(conflito){
      alert(`⚠️ Conflito! ${professor} já está em outro horário.`);
      return;
    }

    td.textContent = `${disciplina} - ${professor}`;
    item.dataset.count = count+1;
  });
});
</script>

</body>
</html>
