<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Sistema de Horários Escolares</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
  :root {
    --cor-primaria: #1976d2;
    --cor-secundaria: #f5f7fa;
    --cor-verde: #4caf50;
    --cor-vermelha: #f44336;
    --cor-texto: #333;
  }
  body { font-family: 'Segoe UI', sans-serif; margin:0; background:var(--cor-secundaria); color:var(--cor-texto);}
  header { background:var(--cor-primaria); color:white; padding:15px; text-align:center; font-weight:bold; }
  .tabs{display:flex;justify-content:center;background:white;border-bottom:2px solid #ddd;}
  .tabs button{flex:1;padding:12px;border:none;background:transparent;cursor:pointer;font-size:1em;}
  .tabs button.active{border-bottom:3px solid var(--cor-primaria);font-weight:bold;}
  .tab{display:none;padding:20px;} .tab.active{display:block;}
  h2{color:var(--cor-primaria);}
  button{background:var(--cor-primaria);color:white;border:none;padding:6px 12px;border-radius:4px;cursor:pointer;}
  button:hover{background:#1259a7;}
  ul{list-style:none;padding:0;} li{background:white;margin:4px 0;padding:6px;border-radius:4px;display:flex;justify-content:space-between;align-items:center;}
  li span{flex:1;} li button{margin-left:5px;font-size:12px;padding:3px 6px;}
  .modal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.5);justify-content:center;align-items:center;z-index:1000;}
  .modal-content{background:white;padding:20px;border-radius:6px;max-width:400px;width:90%;}
  .wizard-step{display:none;} .wizard-step.active{display:block;}
  .prateleira{display:flex;flex-wrap:wrap;gap:8px;background:white;padding:10px;border-radius:6px;margin-bottom:15px;}
  .item{padding:6px 10px;border:1px solid #ddd;border-radius:4px;background:#fafafa;cursor:grab;font-size:12px;}
  .item.verde{background:var(--cor-verde);color:white;}
  table{width:100%;border-collapse:collapse;background:white;}
  th,td{border:1px solid #eee;padding:6px;text-align:center;min-width:90px;vertical-align:middle;}
  th{background:var(--cor-primaria);color:white;}
  td.dropzone{background:#fafafa;height:70px;}
  .aula{background:#e3f2fd;border:1px solid #1976d2;border-radius:4px;padding:2px;font-size:12px;cursor:grab;}
  @media(max-width:768px){th,td{font-size:11px;min-width:60px;}}
</style>
</head>
<body>

<header>Sistema de Horários Escolares</header>
<div class="tabs">
  <button class="active" onclick="showTab('cadastro',this)">Cadastro</button>
  <button onclick="showTab('montar',this)">Montar Horário</button>
</div>

<div id="cadastro" class="tab active">
  <h2>Cadastro</h2>
  <button onclick="openModal('modalTurma')">+ Turma</button>
  <button onclick="openModal('modalDisciplina')">+ Disciplina</button>
  <button onclick="openModal('modalProfessor')">+ Professor</button>
  <h3>Turmas</h3><ul id="listaTurmas"></ul>
  <h3>Disciplinas</h3><ul id="listaDisciplinas"></ul>
  <h3>Professores</h3><ul id="listaProfessores"></ul>
</div>

<div id="montar" class="tab">
  <h2>Montar Horário</h2>
  <label>Turma:</label>
  <select id="turmaSelecionada" onchange="resetarGrade()"></select>
  <h3>Prateleira</h3>
  <div id="prateleira" class="prateleira"></div>
  <h3>Grade</h3>
  <table>
    <thead>
      <tr><th>Horário</th><th>Segunda</th><th>Terça</th><th>Quarta</th><th>Quinta</th><th>Sexta</th></tr>
    </thead>
    <tbody id="grade"></tbody>
  </table>
</div>

<!-- Modal Turma -->
<div id="modalTurma" class="modal"><div class="modal-content">
  <h3>Nova Turma</h3>
  <input id="nomeTurma" placeholder="Nome da turma">
  <button onclick="salvarTurma()">Salvar</button>
  <button onclick="closeModal('modalTurma')">Fechar</button>
</div></div>

<!-- Modal Disciplina -->
<div id="modalDisciplina" class="modal"><div class="modal-content">
  <h3>Nova Disciplina</h3>
  <input id="nomeDisciplina" placeholder="Nome da disciplina">
  <button onclick="salvarDisciplina()">Salvar</button>
  <button onclick="closeModal('modalDisciplina')">Fechar</button>
</div></div>

<!-- Modal Professor Wizard -->
<div id="modalProfessor" class="modal"><div class="modal-content">
  <h3>Novo Professor</h3>
  <div id="wizardStep1" class="wizard-step active">
    <label>Nome:</label><input id="nomeProfessor">
    <button onclick="nextWizard(1)">Próximo</button>
  </div>
  <div id="wizardStep2" class="wizard-step">
    <label>Selecione disciplinas e metas:</label><br>
    <div id="disciplinasWizard"></div>
    <button onclick="prevWizard(2)">Voltar</button>
    <button onclick="nextWizard(2)">Próximo</button>
  </div>
  <div id="wizardStep3" class="wizard-step">
    <label>Disponibilidade (dias):</label><br>
    <label><input type="checkbox" value="Segunda">Segunda</label>
    <label><input type="checkbox" value="Terça">Terça</label>
    <label><input type="checkbox" value="Quarta">Quarta</label>
    <label><input type="checkbox" value="Quinta">Quinta</label>
    <label><input type="checkbox" value="Sexta">Sexta</label><br><br>
    <button onclick="prevWizard(3)">Voltar</button>
    <button onclick="salvarProfessor()">Salvar</button>
  </div>
  <button onclick="closeModal('modalProfessor')">Fechar</button>
</div></div>

<script>
let turmas=[],disciplinas=[],professores=[];
let editando=null; // controle de edição

function showTab(tab,btn){document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));document.getElementById(tab).classList.add('active');document.querySelectorAll('.tabs button').forEach(b=>b.classList.remove('active'));btn.classList.add('active');}
function openModal(id){document.getElementById(id).style.display='flex';if(id==='modalProfessor'){resetWizard();}}
function closeModal(id){document.getElementById(id).style.display='none';editando=null;}

// Turma
function salvarTurma(){let nome=document.getElementById('nomeTurma').value.trim();if(!nome)return; if(editando!==null){turmas[editando].nome=nome;editando=null;}else turmas.push({nome});document.getElementById('nomeTurma').value='';listarTurmas();closeModal('modalTurma');}
function listarTurmas(){let ul=document.getElementById('listaTurmas');ul.innerHTML='';turmas.forEach((t,i)=>{ul.innerHTML+=`<li><span>${t.nome}</span><button onclick="editarTurma(${i})">Editar</button><button onclick="excluirTurma(${i})">Excluir</button></li>`;});updateTurmaSelect();}
function editarTurma(i){editando=i;document.getElementById('nomeTurma').value=turmas[i].nome;openModal('modalTurma');}
function excluirTurma(i){turmas.splice(i,1);listarTurmas();}
function updateTurmaSelect(){let sel=document.getElementById('turmaSelecionada');sel.innerHTML='<option value="">Selecione</option>';turmas.forEach((t,i)=>sel.innerHTML+=`<option value="${i}">${t.nome}</option>`);}

// Disciplina
function salvarDisciplina(){let nome=document.getElementById('nomeDisciplina').value.trim();if(!nome)return;if(editando!==null){disciplinas[editando].nome=nome;editando=null;}else disciplinas.push({nome});document.getElementById('nomeDisciplina').value='';listarDisciplinas();closeModal('modalDisciplina');}
function listarDisciplinas(){let ul=document.getElementById('listaDisciplinas');ul.innerHTML='';disciplinas.forEach((d,i)=>{ul.innerHTML+=`<li><span>${d.nome}</span><button onclick="editarDisciplina(${i})">Editar</button><button onclick="excluirDisciplina(${i})">Excluir</button></li>`;});}
function editarDisciplina(i){editando=i;document.getElementById('nomeDisciplina').value=disciplinas[i].nome;openModal('modalDisciplina');}
function excluirDisciplina(i){disciplinas.splice(i,1);listarDisciplinas();}

// Professor Wizard
function resetWizard(){document.querySelectorAll('.wizard-step').forEach(s=>s.classList.remove('active'));document.getElementById('wizardStep1').classList.add('active');document.getElementById('nomeProfessor').value='';let div=document.getElementById('disciplinasWizard');div.innerHTML='';disciplinas.forEach((d,i)=>{div.innerHTML+=`<label><input type="checkbox" value="${i}" onchange="toggleMetaInput(this)"> ${d.nome} </label> <input type="number" id="meta-${i}" placeholder="meta" style="width:50px;display:none;"><br>`;});document.querySelectorAll('#wizardStep3 input[type=checkbox]').forEach(c=>c.checked=false);}
function toggleMetaInput(chk){let input=document.getElementById('meta-'+chk.value);input.style.display=chk.checked?'inline':'none';}
function nextWizard(step){document.getElementById('wizardStep'+step).classList.remove('active');document.getElementById('wizardStep'+(step+1)).classList.add('active');}
function prevWizard(step){document.getElementById('wizardStep'+step).classList.remove('active');document.getElementById('wizardStep'+(step-1)).classList.add('active');}
function salvarProfessor(){let nome=document.getElementById('nomeProfessor').value.trim();if(!nome){alert("Nome obrigatório");return;}let disciplinasSel=[];document.querySelectorAll('#wizardStep2 input[type=checkbox]:checked').forEach(chk=>{let meta=parseInt(document.getElementById('meta-'+chk.value).value)||0;disciplinasSel.push({disciplina:disciplinas[chk.value].nome,meta,aulas:0});});let disponibilidade=[];document.querySelectorAll('#wizardStep3 input[type=checkbox]:checked').forEach(chk=>disponibilidade.push(chk.value));if(disponibilidade.length===0){alert("Selecione pelo menos um dia!");return;}professores.push({nome,disciplinas:disciplinasSel,disponibilidade});listarProfessores();closeModal('modalProfessor');}
function listarProfessores(){let ul=document.getElementById('listaProfessores');ul.innerHTML='';professores.forEach((p,i)=>{ul.innerHTML+=`<li><span>${p.nome}</span><button onclick="excluirProfessor(${i})">Excluir</button></li>`;});updatePrateleira();}
function excluirProfessor(i){professores.splice(i,1);listarProfessores();}

// Montar Horário
function resetarGrade(){let grade=document.getElementById('grade');grade.innerHTML='';for(let h=1;h<=5;h++){let tr=document.createElement('tr');tr.innerHTML=`<td>${h}ª Aula</td>`;['Segunda','Terça','Quarta','Quinta','Sexta'].forEach(d=>{let td=document.createElement('td');td.className='dropzone';td.dataset.dia=d;td.dataset.horario=h;td.ondragover=e=>e.preventDefault();td.ondrop=drop;tr.appendChild(td);});grade.appendChild(tr);}updatePrateleira();}
function updatePrateleira(){let div=document.getElementById('prateleira');div.innerHTML='';professores.forEach((p,pi)=>{p.disciplinas.forEach((d,di)=>{let item=document.createElement('div');item.className='item';if(d.aulas>=d.meta) item.classList.add('verde');item.textContent=`${d.disciplina} (${p.nome})`;item.draggable=true;item.dataset.prof=pi;item.dataset.disc=di;item.ondragstart=drag;div.appendChild(item);});});}
function drag(e){e.dataTransfer.setData("prof",e.target.dataset.prof);e.dataTransfer.setData("disc",e.target.dataset.disc);}
function drop(e){let prof=professores[e.dataTransfer.getData("prof")];let disc=prof.disciplinas[e.dataTransfer.getData("disc")];let dia=e.currentTarget.dataset.dia;let turmaSel=document.getElementById('turmaSelecionada').value;if(turmaSel===""){alert("Selecione a turma");return;}if(!prof.disponibilidade.includes(dia)){alert("Professor não disponível nesse dia");return;}let ocupado=false;document.querySelectorAll('.aula').forEach(a=>{if(a.dataset.prof==e.dataTransfer.getData("prof") && a.dataset.dia==dia && a.dataset.horario==e.currentTarget.dataset.horario){ocupado=true;}});if(ocupado){alert("Professor já está em outra turma nesse horário");return;}let aula=document.createElement('div');aula.className='aula';aula.textContent=`${disc.disciplina} (${prof.nome})`;aula.dataset.prof=e.dataTransfer.getData("prof");aula.dataset.disc=e.dataTransfer.getData("disc");aula.dataset.dia=dia;aula.dataset.horario=e.currentTarget.dataset.horario;aula.draggable=true;aula.ondragstart=drag; aula.ondblclick=()=>{ if(confirm("Remover aula?")){e.currentTarget.removeChild(aula);disc.aulas--;updatePrateleira();}}; e.currentTarget.appendChild(aula);disc.aulas++;updatePrateleira();}
</script>
</body>
</html>